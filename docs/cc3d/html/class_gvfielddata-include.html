<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<title>GvFieldData Include File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.0.0 on Thu Jan 27 18:48:21 2000 -->
<center>
<a class="qindex"href="index.html">Main Page</a> &nbsp; <a class="qindex"href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex"href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex"href="annotated.html">Compound List</a> &nbsp; <a class="qindex"href="files.html">File List</a> &nbsp; <a class="qindex"href="headers.html">Header Files</a> &nbsp; <a class="qindex"href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex"href="functions.html">Compound Members</a> &nbsp; <a class="qindex"href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>gvfielddata.h</h1>This is the verbatim text of the gvfielddata.h include file.<div class="fragment"><pre>/*=============================================================================

This code is licensed under the Web3D-blaxxun Community Source License,
provided in distribution file LICENSE.TXT and available online at
http://www.web3D.org/TaskGroups/x3d/blaxxun/Web3D-blaxxunCommunitySourceAgreement.html
and may only be used for non-commercial use as specified in that license.

THE WEB3D CONSORTIUM AND BLAXXUN DO NOT MAKE AND HEREBY DISCLAIM ANY EXPRESS
OR IMPLIED WARRANTIES RELATING TO THIS CODE, INCLUDING BUT NOT LIMITED TO,
WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE, OR ANY WARRANTIES THAT MIGHT ARISE FROM A COURSE OF DEALING, USAGE
OR TRADE PRACTICE.  THE COMMUNITY SOURCE CODE IS PROVIDED UNDER THIS
AGREEMENT "AS IS," WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
INCLUDING, WITHOUT LIMITATION, WARRANTIES THAT THE COMMUNITY SOURCE CODE ARE
FREE OF DEFECTS, MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE OR
NON-INFRINGING OR IN ANY WAY CONSTITUTE THE COMPLETE PRODUCT MARKETED UNDER
THE NAMES GIVEN SAID CODE.

==============================================================================*/
#ifndef  _GV_FIELD_DATA_
#define  _GV_FIELD_DATA_
/******************************************************************************
@doc

@module GvFieldData.h - Node field description|

Copyright (c) 1996 - 1998 by Holger Grahn
All rights reserved

Purpose:

Classes:


Notes:

Changes:
$Revision: 1.15 $
$Log: gvfielddata.h,v $
Revision 1.15  1999/07/06 16:34:42  tom
*** empty log message ***


Todo :

******************************************************************************/




#include &lt;gvbasic.h&gt;
#include &lt;gvplist.h&gt;
#include &lt;gvstring.h&gt;


#ifndef _COM
// Support typing for Java and for type checking when parsing routes.
// COM : already in GlviewVrml.h

enum GvFieldClass {
        UnknownType = 0,
        SFBOOL,     SFIMAGE,     SFTIME,
        SFCOLOR,    MFCOLOR,     SFFLOAT,     MFFLOAT,
        SFINT32,    MFINT32,     SFNODE,      MFNODE,
        SFROTATION, MFROTATION,  SFSTRING,    MFSTRING,
        SFVEC2F,    MFVEC2F,     SFVEC3F,     MFVEC3F,
                
                // VRML 2.0
                SFENUM, SFBITMASK, SFMATRIX, SFLONG, MFLONG, 

                // VRML 97
                MFTIME,

                // Inventor
                SFVEC4F,        MFVEC4F
};

#endif

//
// field are storing a value
// 
#ifdef _COM


#include "glviewvrml.h"

typedef FieldType GvFieldClass;

#endif








// to be able to declare pointer to member function 
#include &lt;gvnode.h&gt;

typedef   <a class="code" href="glext.h.html#a131">void</a> (GvNode::*GvNodeEventInMethod)(<a class="code" href="class_gvfield.html">GvField</a> *event);


class <a class="code" href="class_gvconnection.html">GvConnection</a>;

class <a class="code" href="class_gvfield.html">GvField</a>;
class <a class="code" href="class_gvinput.html">GvInput</a>;
class <a class="code" href="class_gvnode.html">GvNode</a>;
class <a class="code" href="class_giotraversal.html">GioTraversal</a>;

// the type pf field or pseudo field
enum GvFieldType {
                GV_FIELD,
                GV_EXPOSED_FIELD,       // field supporting eventIn,Event Out
                GV_FIELD_EVENT_IN,
                GV_FIELD_EVENT_OUT,
                GV_NODE_EVENT_IN, // node is receiving event in
        };


enum GvEventInType {
                GV_EVENT_NODE_EVENT_IN, // node is receiving event in
                GV_EVENT_FIELD_EVENT_IN, // field is receiving event in
        };

// Field // Eventdescriptor
//
class <a class="code" href="class_gvfieldentry.html">GvFieldEntry</a> {
public:

    <a class="code" href="class_gvname.html">GvName</a>              name;   // name of field /event
    long                offset; // binary pointer offset to field in a container node

        // VRML 2.0 type event information

        <a class="code" href="class_typeid.html">TypeId</a>          eventTypeId;    // the event/field type GvSFString ...
        GvFieldType type;       // type of event/field
        GvFieldClass fieldClass; // we need this for VRML script 
        
        <a class="code" href="class_gvfield.html">GvField</a>         *defaultValue; // the default value 

    //void *method;     // EventIn method // could use offset 
    void (GvNode::*method)(<a class="code" href="class_gvfield.html">GvField</a> *event);


        <a class="code" href="class_gvfieldentry.html#a0">GvFieldEntry</a>( const char *Name, long Offset,
                  GvFieldType Type,<a class="code" href="class_typeid.html">TypeId</a> EventTypeId,GvFieldClass FieldClass,
                  <a class="code" href="class_gvfield.html">GvField</a> *Default=NULL) :
                                  name(Name),offset(Offset),
                                          type(Type),fieldClass(FieldClass),
                                          eventTypeId(EventTypeId),defaultValue(Default)
                                        {
                      method = NULL;
                                        }
        <a class="code" href="class_gvfieldentry.html#a0">GvFieldEntry</a>(const <a class="code" href="class_gvfieldentry.html">GvFieldEntry</a> &amp;src);

        <a class="code" href="class_gvfieldentry.html#a2">~GvFieldEntry</a>();
        
        void <a class="code" href="class_gvfield.html#a5">setDefault</a>(<a class="code" href="class_gvfield.html">GvField</a> *newDefault=NULL);

    const <a class="code" href="class_gvname.html">GvName</a> &amp;      <a class="code" href="class_gvfieldentry.html#a4">getName</a>() const
        {return name; }

    const char *<a class="code" href="class_gvfieldentry.html#a5">getType</a>() const;

    const char* <a class="code" href="class_gvfield.html#a13">getFieldType</a>() const;
        //GvFieldClass getFieldType()

    GvBool <a class="code" href="class_gvfield.html#a41">isOutput</a>() { return (type == GV_EXPOSED_FIELD) || (type == GV_FIELD_EVENT_OUT); }
    GvBool <a class="code" href="class_gvfield.html#a40">isInput</a>() { return (type == GV_EXPOSED_FIELD) || (type == GV_FIELD_EVENT_IN) || (type == GV_NODE_EVENT_IN); }

    //GvBool matchFieldType(TypeId otherTypeId) { return(eventTypeId == otherTypeId); }
    
    GvBool <a class="code" href="class_gvfieldentry.html#a9">matchFieldType</a>(<a class="code" href="class_typeid.html">TypeId</a> otherTypeId) { return(otherTypeId.info-&gt;<a class="code" href="class_rtroot.html#a1">IsA</a>(eventTypeId.info)); }
    GvBool <a class="code" href="class_gvfieldentry.html#a9">matchFieldType</a>(GvFieldClass otherType) { return(otherType == fieldClass); }
    GvBool <a class="code" href="class_gvfieldentry.html#a9">matchFieldType</a>(<a class="code" href="class_gvfieldentry.html">GvFieldEntry</a> &amp;other) { return(<a class="code" href="class_gvfieldentry.html#a9">matchFieldType</a>(other.eventTypeId)); }
    GvBool <a class="code" href="class_gvfieldentry.html#a9">matchFieldType</a>(<a class="code" href="class_gvfield.html">GvField</a>*  field);
    
    <a class="code" href="class_gvfield.html">GvField</a> *<a class="code" href="class_gvfieldentry.html#a13">getDefault</a>() const { return(defaultValue); }

    // create a new field with the type of this fieldEntry
    // and optionally assign the default value
    <a class="code" href="class_gvfield.html">GvField</a>* <a class="code" href="class_gvfieldentry.html#a14">createInstance</a>() const;


};

#if 0

// EventIn desrciptor
//
class GvEventInEntry {
public:

    <a class="code" href="class_gvname.html">GvName</a>              name;   // name of event
        GvEventInType type;     // type of eventIn
        <a class="code" href="class_typeid.html">TypeId</a>  eventTypeId;    // the event/field type GvSFString ...
        void *method;   // EventIn method // could use offset

//    GvNodeEventInMethod nodeMethod;

        GvEventInEntry(const char *Name, void *Method,<a class="code" href="class_typeid.html">TypeId</a> EventTypeId, GvEventInType Type) :
                                        name(Name),method(Method),eventTypeId(EventTypeId), type(Type)
                                        {
                                        }
};
#endif


struct <a class="code" href="class_gvenumentry.html">GvEnumEntry</a> {
    <a class="code" href="class_gvname.html">GvName</a>              typeName;
    int                 num;
    int                 arraySize;
    int                 *vals;
    <a class="code" href="class_gvname.html">GvName</a>              *names;                 
    <a class="code" href="class_gvenumentry.html#a0">GvEnumEntry</a>(const <a class="code" href="class_gvname.html">GvName</a> &amp;name);
    <a class="code" href="class_gvenumentry.html#a1">~GvEnumEntry</a>();

    static int          growSize;
};


class <a class="code" href="class_gvfielddata.html">GvFieldData</a> {
  public:
    <a class="code" href="class_gvfield.html#l0">GvFieldData</a>() {}
    <a class="code" href="class_gvfielddata.html#a1">~GvFieldData</a>();

        // Fields
        
        // add a field descriptor, 
    // fieldDefault NULL, or ptr is owned
    // offset is computed relative to defObject !! to do: how to deal with Proto, Script fields
    //
    <a class="code" href="class_gvfieldentry.html">GvFieldEntry</a>* <a class="code" href="class_gvfielddata.html#a2">addField</a>(<a class="code" href="class_gvnode.html">GvNode</a> *defObject, const char *fieldName, const <a class="code" href="class_gvfield.html">GvField</a> *field,GvFieldType type=GV_EXPOSED_FIELD,<a class="code" href="class_gvfield.html">GvField</a>* fieldDefault=NULL);

    <a class="code" href="class_gvfieldentry.html">GvFieldEntry</a>* <a class="code" href="class_gvfielddata.html#a2">addField</a>(<a class="code" href="class_gvfieldentry.html">GvFieldEntry</a> *entry);

    // get number of fields
    int <a class="code" href="class_gvfielddata.html#a4">getNumFields</a>() const    { return fields.<a class="code" href="class_gvplist.html#a7">getLength</a>(); }

    // get name for field #i
    const <a class="code" href="class_gvname.html">GvName</a> &amp;      <a class="code" href="class_gvfielddata.html#a5">getFieldName</a>(int index) const
        {return ((<a class="code" href="class_gvfieldentry.html">GvFieldEntry</a> *) fields[index])-&gt;name; }

        // get event in name for field #i
        <a class="code" href="class_gvname.html">GvName</a> <a class="code" href="class_gvfielddata.html#a6">getEventInName</a>(int index) const;

        // get event out name for field #i
        <a class="code" href="class_gvname.html">GvName</a> <a class="code" href="class_gvfielddata.html#a7">getEventOutName</a>(int index) const;

    // get field type name for field #i
    const char * <a class="code" href="class_gvfield.html#a13">getFieldType</a>(const <a class="code" href="class_gvnode.html">GvNode</a> *object,int index) const;    // HG

    // get field ptr in node object  for field #i
    <a class="code" href="class_gvfield.html">GvField</a> *   <a class="code" href="class_gvfielddata.html#a9">getField</a>(const <a class="code" href="class_gvnode.html">GvNode</a> *object, int index) const;

        <a class="code" href="class_gvfieldentry.html">GvFieldEntry</a> *<a class="code" href="class_gvfielddata.html#a10">getFieldEntry</a>(int index) const { return ((<a class="code" href="class_gvfieldentry.html">GvFieldEntry</a> *) fields[index]); }

    // Find field with name fieldName in object
    // NULL if field not found
    <a class="code" href="class_gvfield.html">GvField</a>*    <a class="code" href="class_gvfielddata.html#a9">getField</a>(const <a class="code" href="class_gvnode.html">GvNode</a> *object,const char * fieldName) const;

    // Find field with name fieldName in object, Result -1 if not found
    int <a class="code" href="class_gvfielddata.html#a12">getFieldIndex</a>(const char *fieldName) const;

        // add EventIn
    <a class="code" href="class_gvfieldentry.html">GvFieldEntry</a>*
    <a class="code" href="class_gvfielddata.html#a13">addEventIn</a>(<a class="code" href="class_gvnode.html">GvNode</a> *defObject, const char *eventName,GvNodeEventInMethod  method, 
        <a class="code" href="class_typeid.html">TypeId</a> eventTypeId, GvFieldClass eventFieldClass, GvFieldType type=GV_NODE_EVENT_IN);
    
    // get number of eventsIn
    // int      getNumEventsIn() const  { return eventsIn.getLength(); }
        //GvEventInEntry *getEventInEntry(int index) const {   return ((GvEventInEntry *) eventsIn[index]); }

        // lookup event/field info, and return a toConection object 
        <a class="code" href="class_gvconnection.html">GvConnection</a>* <a class="code" href="class_gvfielddata.html#a14">getConnectionIn</a>(<a class="code" href="class_gvnode.html">GvNode</a> *object,const char *eventName, <a class="code" href="class_typeid.html">TypeId</a>      eventTypeId) const;

        // lookup event/field info, and return a fromConection object 
        <a class="code" href="class_gvfield.html">GvField</a>* <a class="code" href="class_gvfielddata.html#a15">getConnectionOut</a>(const <a class="code" href="class_gvnode.html">GvNode</a> *object,const char *eventName) const;

    // Find eventIn with name eventName in object
    // -1 if event not found 
    int  <a class="code" href="class_gvfielddata.html#a16">getEventInIndex</a>(<a class="code" href="class_gvnode.html">GvNode</a> *object,const char * eventName, <a class="code" href="class_typeid.html">TypeId</a>  eventTypeId) const;
    int  <a class="code" href="class_gvfielddata.html#a16">getEventInIndex</a>(<a class="code" href="class_gvnode.html">GvNode</a> *object,const char * eventName) const;

    // Find eventOut with name eventName in object
    // return index in event info, -1 if event not found 
    int  <a class="code" href="class_gvfielddata.html#a18">getEventOutIndex</a>(const <a class="code" href="class_gvnode.html">GvNode</a> *object,const char * eventName) const;

    // computes copyOnInstance flag from any child nodes flag set
    GvBool <a class="code" href="class_gvfielddata.html#a19">computeCopyOnInstance</a>(<a class="code" href="class_gvnode.html">GvNode</a> *node,<a class="code" href="class_gvcopycontext.html">GvCopyContext</a> &amp;context);
    GvBool <a class="code" href="class_gvfielddata.html#a20">copyOnInstance</a>(<a class="code" href="class_gvnode.html">GvNode</a> *node);



        // Enum

    void                <a class="code" href="class_gvfielddata.html#a21">addEnumValue</a>(const char *typeName,
                                     const char *valName, int val);
    void                <a class="code" href="class_gvfielddata.html#a22">getEnumData</a>(const char *typeName, int &amp;num,
                                    const int *&amp;vals, const <a class="code" href="class_gvname.html">GvName</a> *&amp;names);

    GvBool              <a class="code" href="class_gvfield.html#a10">read</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, <a class="code" href="class_gvnode.html">GvNode</a> *object,
                             GvBool errorOnUnknownField = TRUE) const;

    GvBool              <a class="code" href="class_gvfield.html#a10">read</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, <a class="code" href="class_gvnode.html">GvNode</a> *object,
                             const <a class="code" href="class_gvname.html">GvName</a> &amp;fieldName,
                             GvBool &amp;foundName) const;

    GvBool              <a class="code" href="class_gvfielddata.html#a25">readFieldTypes</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, <a class="code" href="class_gvnode.html">GvNode</a> *object);

    GvBool      <a class="code" href="class_gvfielddata.html#a26">readInterfaceElement</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in,GvBool alreadyHasFields,<a class="code" href="class_gvnode.html">GvNode</a> *object,GvBool readDefaults=TRUE);

    // read proto fields / interface 
        GvBool      <a class="code" href="class_gvfielddata.html#a27">readProtoInterface</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, <a class="code" href="class_gvnode.html">GvNode</a> *object,GvBool externProto=FALSE);
    GvBool      <a class="code" href="class_gvfielddata.html#a28">readScriptInterface</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, <a class="code" href="class_gvnode.html">GvNode</a> *object);

        // set field data from src 
        void <a class="code" href="class_gvfield.html#a20">set</a>(<a class="code" href="class_gvfielddata.html">GvFieldData</a> &amp;src);


        // write all fields of node 
        int <a class="code" href="class_gvfield.html#a18">Do</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state, <a class="code" href="class_gvnode.html">GvNode</a> *object);

        // write a single field including PROTO IS connections 
        int <a class="code" href="class_gvfield.html#a18">Do</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state, <a class="code" href="class_gvnode.html">GvNode</a> *object,int index);

        // write all IsConnections of node 
        int <a class="code" href="class_gvfielddata.html#a32">DoIsConnections</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state, <a class="code" href="class_gvnode.html">GvNode</a> *object);

        int <a class="code" href="class_gvfielddata.html#a33">DoFieldTypes</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state,const <a class="code" href="class_gvnode.html">GvNode</a> *object);

    // write interface for Proto, externproto etc.
    int <a class="code" href="class_gvfielddata.html#a34">DoInterface</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state,const <a class="code" href="class_gvnode.html">GvNode</a> *object,GvBool writeDefaults= TRUE,int offset=0);

        // write interface for Script 
        int <a class="code" href="class_gvfielddata.html#a35">DoScriptInterface</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state, <a class="code" href="class_gvnode.html">GvNode</a> *object,int offset);





  private:
    <a class="code" href="class_gvplist.html">GvPList</a>             fields;
    <a class="code" href="class_gvplist.html">GvPList</a>             enums;

};    


// store a list of field pointers
// fields are deleted on deletion
//

class <a class="code" href="class_gvfieldlist.html">GvFieldList</a> : public <a class="code" href="class_gvplist.html">GvPList</a> {
  public:
    
    <a class="code" href="class_gvfieldlist.html#a0">GvFieldList</a>(int size=0) : <a class="code" href="class_gvplist.html">GvPList</a>(size) {}

    // delete all fields and truncate
    void <a class="code" href="class_gvfieldlist.html#a1">DeleteFields</a>(); 

    
    <a class="code" href="class_gvfieldlist.html#a2">~GvFieldList</a>();

    void <a class="code" href="class_gvplist.html#a2">append</a>(<a class="code" href="class_gvfield.html">GvField</a> *newField); 
    
    // set field pointer at index, list is expandend
    // old value is not freed
    void <a class="code" href="class_gvfield.html#a20">set</a>(int index, <a class="code" href="class_gvfield.html">GvField</a> *newField);

    <a class="code" href="class_gvfield.html">GvField</a>*    &amp; operator [](int i) 
        { return ( (<a class="code" href="class_gvfield.html">GvField</a> * &amp;) ( (*(<a class="code" href="class_gvplist.html">GvPList</a> *) this) [i] ) ); }
    
    <a class="code" href="class_gvfield.html">GvField</a>*     operator [](int i) const 
        { return ( (<a class="code" href="class_gvfield.html">GvField</a> *) ( (*(<a class="code" href="class_gvplist.html">GvPList</a> *) this) [i] ) ); }

};



#endif /* _GV_FIELD_DATA_ */
</div></pre><hr><address><small>Generated at Thu Jan 27 18:48:21 2000 for blaxxunContact3D by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align=center border=0 
width=118 height=53></a> 1.0.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy; 1997-1999</small></address>
</body>
</html>
