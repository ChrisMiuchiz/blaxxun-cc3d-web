<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<title>GvField Include File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.0.0 on Thu Jan 27 18:48:20 2000 -->
<center>
<a class="qindex"href="index.html">Main Page</a> &nbsp; <a class="qindex"href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex"href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex"href="annotated.html">Compound List</a> &nbsp; <a class="qindex"href="files.html">File List</a> &nbsp; <a class="qindex"href="headers.html">Header Files</a> &nbsp; <a class="qindex"href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex"href="functions.html">Compound Members</a> &nbsp; <a class="qindex"href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>gvfield.h</h1>This is the verbatim text of the gvfield.h include file.<div class="fragment"><pre>/*=============================================================================

This code is licensed under the Web3D-blaxxun Community Source License,
provided in distribution file LICENSE.TXT and available online at
http://www.web3D.org/TaskGroups/x3d/blaxxun/Web3D-blaxxunCommunitySourceAgreement.html
and may only be used for non-commercial use as specified in that license.

THE WEB3D CONSORTIUM AND BLAXXUN DO NOT MAKE AND HEREBY DISCLAIM ANY EXPRESS
OR IMPLIED WARRANTIES RELATING TO THIS CODE, INCLUDING BUT NOT LIMITED TO,
WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE, OR ANY WARRANTIES THAT MIGHT ARISE FROM A COURSE OF DEALING, USAGE
OR TRADE PRACTICE.  THE COMMUNITY SOURCE CODE IS PROVIDED UNDER THIS
AGREEMENT "AS IS," WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
INCLUDING, WITHOUT LIMITATION, WARRANTIES THAT THE COMMUNITY SOURCE CODE ARE
FREE OF DEFECTS, MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE OR
NON-INFRINGING OR IN ANY WAY CONSTITUTE THE COMPLETE PRODUCT MARKETED UNDER
THE NAMES GIVEN SAID CODE.

==============================================================================*/
#ifndef  _GV_FIELD_
#define  _GV_FIELD_
/******************************************************************************
@doc

@module GvField.h - root class for VRML fields|

Copyright (c) 1996 - 1998 by Holger Grahn
All rights reserved

Purpose:

Classes:
&lt;c GvField&gt;
        &lt;c GvSField&gt;
        &lt;c GvMField&gt;

Notes:

Changes:
$Revision: 1.19 $
$Log: gvfield.h,v $
Revision 1.19  1999/07/06 16:34:41  tom
*** empty log message ***

Revision 1.18  1999/05/10 13:53:46  tom
*** empty log message ***



Todo :

******************************************************************************/



#include &lt;gvstring.h&gt;

class <a class="code" href="class_astream.html">AStream</a>;
class <a class="code" href="class_giotraversal.html">GioTraversal</a>;
class <a class="code" href="class_gdisplaytreetraversal.html">GDisplayTreeTraversal</a>;

class <a class="code" href="class_gvinput.html">GvInput</a>;
class <a class="code" href="class_gvnode.html">GvNode</a>;
class <a class="code" href="class_gvfield.html">GvField</a>;
class <a class="code" href="class_gvconnection.html">GvConnection</a>;

#include &lt;gvfielddata.h&gt;
#include &lt;gvconnection.h&gt;


//
// field are storing a value
// 
#ifdef _COM


//#include "glviewvrml.h"
//typedef FieldType GvFieldClass;

// default COM methods for FIELD 
#define COM_DEFAULT_SFIELD_METHODS() \
    /* IUnknown methods */ \
        STDMETHOD_(ULONG, AddRef)() { return InternalAddRef();  } \
        STDMETHOD_(ULONG, Release)() { return InternalRelease();  } \
        STDMETHOD(QueryInterface)(REFIID iid, void ** ppvObject) {return _InternalQueryInterface(iid, ppvObject);} \
        \
    /* EventIn methods */ \
    STDMETHOD(getType)(int *type) { return GvField::getType(type); } \
        STDMETHOD(setValueFromString)( /* [in] */ BSTR value) { return GvField::setValueFromString(value); } \
    \
        /* EventOut methods */  \
    STDMETHOD(advise)(<a class="code" href="class_eventoutobserver.html">EventOutObserver</a> *observer, IDispatch* userData) { return GvField::advise(observer,userData); } \
    STDMETHOD(unAdvise)(<a class="code" href="class_eventoutobserver.html">EventOutObserver</a> *observer) { return GvField::unAdvise(observer); } \
        STDMETHOD(toString) (/* [retval][out] */ BSTR  *value) { return GvField::toString(value); } \


#define COM_DEFAULT_MFIELD_METHODS() COM_DEFAULT_SFIELD_METHODS()

// notify browser of an extern touch of field ==&gt; redraw 
#define COM_EXTERN_TOUCH()      /* GvConnection::connectionsTriggeredCnt++ */ 


// temp hack definitions for Vec4f
#define SFVEC4F  SFVEC3F
#define MFVEC4F  MFVEC3F

#endif


//
// GvField : Root for all field classes
//




class <a class="code" href="class_gvfield.html">GvField</a> : 
        public <a class="code" href="class_rtroot.html">RTRoot</a>

#ifdef _COM
        ,public CComDualImpl&lt;Field, &amp;IID_Field, &amp;LIBID_GLViewVrmlLib&gt;
        ,public CComDualImpl&lt;EventIn, &amp;IID_EventIn, &amp;LIBID_GLViewVrmlLib&gt;
        ,public CComDualImpl&lt;EventOut, &amp;IID_EventOut, &amp;LIBID_GLViewVrmlLib&gt;
#endif

{

public: 


#ifdef _COM


        BEGIN_COM_MAP(<a class="code" href="class_gvfield.html">GvField</a>)
                //COM_INTERFACE_ENTRY(IDispatch)
                COM_INTERFACE_ENTRY(<a class="code" href="class_field.html">Field</a>)
                COM_INTERFACE_ENTRY(<a class="code" href="class_eventin.html">EventIn</a>)
                COM_INTERFACE_ENTRY(<a class="code" href="class_eventout.html">EventOut</a>)
        END_COM_MAP()

        DECLARE_NOT_AGGREGATABLE(<a class="code" href="class_gvfield.html">GvField</a>)


        // propagate to node containing field
        ULONG InternalAddRef();
        ULONG InternalRelease();

        // ATL 2.0 
        void Lock() {}
        void Unlock() {}


    /* IUnknown methods */
        STDMETHOD_(ULONG, AddRef)(); 
        STDMETHOD_(ULONG, Release)();
        STDMETHOD(QueryInterface)(REFIID iid, void ** ppvObject)
        {return _InternalQueryInterface(iid, ppvObject);}

        // needed static Methods from CComObjectRoot 
        static HRESULT WINAPI InternalQueryInterface(void* pThis,
                const _ATL_INTMAP_ENTRY* entries, REFIID iid, void** ppvObject);
        static HRESULT WINAPI _Chain(void* pv, REFIID iid, void** ppvObject, DWORD dw);


    /* Field methods */
    STDMETHOD(getType)(int * type);
        STDMETHOD(setValueFromString)( /* [in] */ BSTR value);

        /* EventOut methods */ 
    STDMETHOD(advise)(<a class="code" href="class_eventoutobserver.html">EventOutObserver</a> *observer, IDispatch* userData);
    STDMETHOD(unAdvise)(<a class="code" href="class_eventoutobserver.html">EventOutObserver</a> *observer);
        STDMETHOD(toString) (/* [retval][out] */ BSTR  *value);


#endif 

  public:
        <a class="code" href="class_gvfield.html#a0">RT</a>(<a class="code" href="class_rtroot.html">RTRoot</a>);

    virtual <a class="code" href="class_gvfield.html#a1">~GvField</a>();

    void                <a class="code" href="class_gvfield.html#a2">setIgnored</a>(GvBool ig)   { flags.ignored = ig;   }
    GvBool              <a class="code" href="class_gvfield.html#a3">isIgnored</a>() const       { return flags.ignored; }

    inline GvBool               <a class="code" href="class_gvfield.html#a4">isDefault</a>() const       { return flags.hasDefault; }

    inline void         <a class="code" href="class_gvfield.html#a5">setDefault</a>(GvBool def)  { flags.hasDefault = def; }

        // modified flag
    inline GvBool               <a class="code" href="class_gvfield.html#a6">isModified</a>() const      { return flags.modified; }

    inline void         <a class="code" href="class_gvfield.html#a7">setModified</a>(GvBool def) { flags.modified = def; }


    void                <a class="code" href="class_gvfield.html#a8">setContainer</a>(<a class="code" href="class_gvnode.html">GvNode</a> *cont);

    inline <a class="code" href="class_gvnode.html">GvNode</a> *     <a class="code" href="class_gvfield.html#a9">getContainer</a>() const    { return container; }

    GvBool              <a class="code" href="class_gvfield.html#a10">read</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, const <a class="code" href="class_gvname.html">GvName</a> &amp;name);

    <a class="code" href="class_gvfield.html#a11">GvField</a>()           { 
        flags.hasDefault = TRUE; 
        flags.ignored = FALSE; 
        flags.modified = FALSE; 
        flags.isInput = TRUE; 
        flags.isOutput = TRUE; 
        flags.connectionsEnabled = TRUE; 
        container = NULL;
        connections = NULL;
    }


        virtual const char * <a class="code" href="class_gvfield.html#a12">GetType</a>();

        virtual GvFieldClass <a class="code" href="class_gvfield.html#a13">getFieldType</a>() const = 0;

        virtual int <a class="code" href="class_gvfield.html#a14">io</a>(<a class="code" href="class_astream.html">AStream</a> &amp;<a class="code" href="class_a.html">a</a>, const <a class="code" href="class_gvname.html">GvName</a> &amp;name);
    
        virtual int <a class="code" href="class_gvfield.html#a15">interpolateFrom</a>(<a class="code" href="class_gvfield.html">GvField</a> *<a class="code" href="class_a.html">a</a>,<a class="code" href="class_gvfield.html">GvField</a> *b, float t);



  public:

  public:
        struct {
        unsigned int hasDefault         : 1;    
        unsigned int ignored            : 1;    
        unsigned int modified           : 1;    
        unsigned int isInput            : 1;    
        unsigned int isOutput           : 1;    
        unsigned int connectionsEnabled : 1;  

    }   flags;


    <a class="code" href="class_gvnode.html">GvNode</a>              *container;

    static <a class="code" href="class_gvfield.html">GvField</a> *<a class="code" href="class_gvfield.html#d0">createInstanceFromName</a>(const <a class="code" href="class_gvname.html">GvName</a> &amp;className);

    virtual GvBool      <a class="code" href="class_gvfield.html#a16">readValue</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in) = 0;
        
        virtual int <a class="code" href="class_gvfield.html#a17">ioValue</a>(<a class="code" href="class_astream.html">AStream</a> &amp;<a class="code" href="class_a.html">a</a>);

    virtual int <a class="code" href="class_gvfield.html#a18">Do</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state);

    virtual int <a class="code" href="class_gvfield.html#a19">get</a>(<a class="code" href="class_gvstring.html">GvString</a> &amp;value);

        virtual int <a class="code" href="class_gvfield.html#a20">set</a>(const char* value);


    virtual const <a class="code" href="class_gvfield.html">GvField</a>&amp; operator =(const <a class="code" href="class_gvfield.html">GvField</a> &amp;f) = 0;

    virtual int <a class="code" href="class_gvfield.html#a20">set</a>(const <a class="code" href="class_gvfield.html">GvField</a> *value);

        virtual <a class="code" href="class_gvfield.html">GvField</a>* <a class="code" href="class_gvfield.html#a23">copy</a>();

    <a class="code" href="class_gvconnection.html">GvConnection</a>* connections;
    
    GvBool <a class="code" href="class_gvfield.html#a24">hasConnections</a>() { return(connections != NULL); }

    <a class="code" href="class_gvconnection.html">GvConnection</a>*  <a class="code" href="class_gvfield.html#a25">getConnections</a>() { return(connections); }
    
    int <a class="code" href="class_gvfield.html#a26">deleteConnections</a>();
    
    GvBool <a class="code" href="class_gvfield.html#a27">addConnection</a>(<a class="code" href="class_gvconnection.html">GvConnection</a> *connection,GvBool trigger=FALSE);
    
    GvBool <a class="code" href="class_gvfield.html#a28">removeConnection</a>(<a class="code" href="class_gvconnection.html">GvConnection</a> *connection);

        GvBool <a class="code" href="class_gvfield.html#a28">removeConnection</a>(GvBool (*Pred)(<a class="code" href="class_gvconnection.html">GvConnection</a> *c, void *data),void *data);

        <a class="code" href="class_gvconnection.html">GvConnection</a>* <a class="code" href="class_gvfield.html#a30">findConnection</a>(GvBool (*Pred)(<a class="code" href="class_gvconnection.html">GvConnection</a> *c, void *data),void *data);


    // removes connections to a node
    // int removeConnections(GvNode *node);

    // removes connections to a field
    // int removeConnections(GvField *field);

    int <a class="code" href="class_gvfield.html#a31">OnTrigger</a>();

    int <a class="code" href="class_gvfield.html#a32">touch</a>() { 
            int ret = 0;
            flags.modified = TRUE; 

            if (<a class="code" href="class_gvfield.html#a24">hasConnections</a>() &amp;&amp; <a class="code" href="class_gvfield.html#a34">connectionsEnabled</a>()) { 
                 <a class="code" href="class_gvfield.html#a35">enableConnections</a>(0);  // prevent recursive looping
                       ret=<a class="code" href="class_gvfield.html#a31">OnTrigger</a>(); 
                 <a class="code" href="class_gvfield.html#a35">enableConnections</a>(1);
            }
            return(ret);
    }
    void <a class="code" href="class_gvfield.html#a33">untouch</a>()      { flags.modified = FALSE; }
    
    int <a class="code" href="class_gvfield.html#a34">connectionsEnabled</a>() const { return(flags.connectionsEnabled); }
    
    int <a class="code" href="class_gvfield.html#a35">enableConnections</a>(int flag)     { 
                int old = (flags.connectionsEnabled); 
                flags.connectionsEnabled=flag; 
                return (old);
            }
        

        int <a class="code" href="class_gvfield.html#a36">OnChanged</a>();

        friend class <a class="code" href="class_gvfielddata.html">GvFieldData</a>;
};


#ifdef _COM_XXX

// a static helper to get the vtable ?

class GvFieldTearOff : <a class="code" href="class_gvfield.html">GvField</a>
        ,public CComDualImpl&lt;Field, &amp;IID_Field, &amp;LIBID_GLViewVrmlLib&gt;
        ,public CComDualImpl&lt;EventIn, &amp;IID_EventIn, &amp;LIBID_GLViewVrmlLib&gt;
        ,public CComDualImpl&lt;EventOut, &amp;IID_EventOut, &amp;LIBID_GLViewVrmlLib&gt;
{

};

static GvFieldTearOff __fieldTearOff;


#endif



class <a class="code" href="class_gvsfield.html">GvSField</a> : public <a class="code" href="class_gvfield.html">GvField</a> {

  public:
        <a class="code" href="class_gvfield.html#a0">RT</a>(<a class="code" href="class_gvfield.html">GvField</a>);

    virtual <a class="code" href="class_gvsfield.html#a1">~GvSField</a>();
        
        int <a class="code" href="class_gvfield.html#a18">Do</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state);

  protected:
    <a class="code" href="class_gvsfield.html#b0">GvSField</a>();

  private:
  public:       

    virtual GvBool      <a class="code" href="class_gvfield.html#a16">readValue</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in) = 0;

};


class <a class="code" href="class_gvmfield.html">GvMField</a> : public <a class="code" href="class_gvfield.html">GvField</a> {

  public:
        <a class="code" href="class_gvfield.html#a0">RT</a>(<a class="code" href="class_gvfield.html">GvField</a>);
    int                 num;            
    int                 maxNum;         

    virtual <a class="code" href="class_gvmfield.html#a1">~GvMField</a>();

  protected:

    <a class="code" href="class_gvmfield.html#b0">GvMField</a>();
  
  public:      
        virtual GvFieldClass <a class="code" href="class_gvmfield.html#a2">getSFFieldType</a>() const = 0;

    virtual void        <a class="code" href="class_gvmfield.html#a3">makeRoom</a>(int newNum);

  private:
    virtual void        <a class="code" href="class_gvmfield.html#c0">allocValues</a>(int num) = 0;

    virtual GvBool      <a class="code" href="class_gvmfield.html#c1">read1Value</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, int index) = 0;

  public:  

        virtual GvBool  <a class="code" href="class_gvfield.html#a16">readValue</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in);

    GvBool <a class="code" href="class_gvmfield.html#a5">readValueList</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in,int endChar);


  public:

        inline int <a class="code" href="class_gvmfield.html#a6">getNum</a>() const { return(num); }

        inline int <a class="code" href="class_gvmfield.html#a7">getMaxNum</a>() const { return(maxNum); }

        inline int <a class="code" href="class_gvmfield.html#a8">Length</a>() const { return(num); }
        inline int <a class="code" href="class_gvmfield.html#a9">MaxLength</a>() const  { return(maxNum); }

        void <a class="code" href="class_gvmfield.html#a10">setLength</a>(int newLength) { <a class="code" href="class_gvmfield.html#a3">makeRoom</a>(newLength); }
        
        virtual int <a class="code" href="class_gvfield.html#a17">ioValue</a>(<a class="code" href="class_astream.html">AStream</a> &amp;<a class="code" href="class_a.html">a</a>);  // not needed
    virtual int <a class="code" href="class_gvmfield.html#a12">io1Value</a>(<a class="code" href="class_astream.html">AStream</a> &amp;<a class="code" href="class_a.html">a</a>, int index);

        // string conversion 
        virtual int <a class="code" href="class_gvfield.html#a19">get</a>(<a class="code" href="class_gvstring.html">GvString</a> &amp;value);
        virtual int <a class="code" href="class_gvfield.html#a20">set</a>(const char* value);
        
        virtual int <a class="code" href="class_gvmfield.html#a15">get1</a>(<a class="code" href="class_gvstring.html">GvString</a> &amp;value, int index);
        virtual int <a class="code" href="class_gvmfield.html#a16">set1</a>(const char* value, int index);

        virtual <a class="code" href="class_gvfield.html">GvField</a>* <a class="code" href="class_gvmfield.html#a17">get1Field</a>(int index) = 0;

        virtual int <a class="code" href="class_gvfield.html#a18">Do</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state);
        virtual int <a class="code" href="class_gvfield.html#a18">Do</a>(<a class="code" href="class_gdisplaytreetraversal.html">GDisplayTreeTraversal</a> &amp;state); // implemented in GDisplayTree.cpp

    // each instance will normally have an valueType *values; entry

    // macros are adding functions like

    // int set(int newNum,const valueType *newValues);
    // const className &amp; operator= (const className &amp;f) { set(f.num,f.values);return(f); }

};

#endif /* _GV_FIELD_ */

</div></pre><hr><address><small>Generated at Thu Jan 27 18:48:21 2000 for blaxxunContact3D by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align=center border=0 
width=118 height=53></a> 1.0.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy; 1997-1999</small></address>
</body>
</html>
