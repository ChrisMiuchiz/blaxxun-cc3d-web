<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<title>image_ Include File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.0.0 on Thu Jan 27 18:55:25 2000 -->
<center>
<a class="qindex"href="index.html">Main Page</a> &nbsp; <a class="qindex"href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex"href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex"href="annotated.html">Compound List</a> &nbsp; <a class="qindex"href="files.html">File List</a> &nbsp; <a class="qindex"href="headers.html">Header Files</a> &nbsp; <a class="qindex"href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex"href="functions.html">Compound Members</a> &nbsp; <a class="qindex"href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>image.h</h1>This is the verbatim text of the image.h include file.<div class="fragment"><pre>/*=============================================================================

This code is licensed under the Web3D-blaxxun Community Source License,
provided in distribution file LICENSE.TXT and available online at
http://www.web3D.org/TaskGroups/x3d/blaxxun/Web3D-blaxxunCommunitySourceAgreement.html
and may only be used for non-commercial use as specified in that license.

THE WEB3D CONSORTIUM AND BLAXXUN DO NOT MAKE AND HEREBY DISCLAIM ANY EXPRESS
OR IMPLIED WARRANTIES RELATING TO THIS CODE, INCLUDING BUT NOT LIMITED TO,
WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE, OR ANY WARRANTIES THAT MIGHT ARISE FROM A COURSE OF DEALING, USAGE
OR TRADE PRACTICE.  THE COMMUNITY SOURCE CODE IS PROVIDED UNDER THIS
AGREEMENT "AS IS," WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
INCLUDING, WITHOUT LIMITATION, WARRANTIES THAT THE COMMUNITY SOURCE CODE ARE
FREE OF DEFECTS, MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE OR
NON-INFRINGING OR IN ANY WAY CONSTITUTE THE COMPLETE PRODUCT MARKETED UNDER
THE NAMES GIVEN SAID CODE.

==============================================================================*/
#ifndef _IMAGE_H
#define _IMAGE_H

#ifdef _DEBUG
#ifdef WIN32

// MS-VC Runtime MEM debugging
#include &lt;crtdbg.h&gt;

#endif
#endif


#ifdef __cplusplus
extern "C" {
#endif

/*
  generic image storage object
*/

#define IBITSET(v, thebit)      (((v) &amp; (1&lt;&lt;thebit)) != 0)
/* word long flipping */
#define IFLIPS(A) { A = ( (unsigned short)(A) &gt;&gt; 8) | (((unsigned short)(A) &amp; 0XFF) &lt;&lt; 8); }
#define IFLIPEDS(A) (( (unsigned short)(A) &gt;&gt; 8) | (((unsigned short)(A) &amp; 0XFF) &lt;&lt; 8))
#define IFLIPL(A) { A = ( ((unsigned long)(A) &gt;&gt; 24) | (((unsigned long)(A) &gt;&gt; 8) &amp; 0X00FF00l)  \
        | (((unsigned long)(A) &lt;&lt; 8) &amp; 0X00FF0000l) | (((unsigned long)(A) &lt;&lt; 24) &amp; 0XFF000000l)); }


/* out of error */
#define IME_ERROR -1
#define IME_NOMEM -2
#define IME_BADFMT -3
#define IME_INCOMPATIBLEFMT -4
#define IME_BADFILE -5
#define IME_NOFILE -6
#define IME_FILEIO -7
#define IME_NOTIMP -8
#define IME_NOCMAP -9
#define IME_BADIMAGE -10
#define IME_RANGE -11
#define IME_BADOP -12




/* image format types */
#define IM_BW 1
#define IM_GRAY 2
#define IM_MAPPED4 3
#define IM_MAPPED8 4
#define IM_MAPPED16 5
#define IM_RGB15 6
#define IM_RGB16 7
#define IM_RGB24 8
#define IM_RGB 8
#define IM_RGB32 9
#define IM_RGBA 10

#define IM_RGB_SHORT 11
#define IM_RGBA_SHORT 12
#define IM_GRAYA 13 


#define HOOPS_IM_FORMATS ((1&lt;&lt;IM_MAPPED8) | (1&lt;&lt;IM_MAPPED16) | (1&lt;&lt;IM_RGB24) ) | (1&lt;&lt;IM_RGBA) )

#define IM_NO_COMPRESSION 0
#define IM_RLE_COMPRESSION 1

#define IBYTE unsigned char
#define IWORD unsigned short
#define ISHORT short
#define ILONG unsigned long

/* alpha ops */
enum IMAGE_OP {
        IMOP_NOOP,
        IMOP_SETR,
        IMOP_SETG,
        IMOP_SETB,
        IMOP_SETA,
        IMOP_SETRGB,
        IMOP_SETRGBA,
        IMOP_SETA_IF_RGBEQ,
        IMOP_RGB_IF_AEQ,

        IMOP_COPY_DEST,
        IMOP_COPY_SRC,
        IMOP_COPY_SRC_CLAMP,
        IMOP_ADD,
        IMOP_SUB,
        IMOP_MUL,
        IMOP_DIV,
        IMOP_MIN,
        IMOP_MAX,
        IMOP_ADDC,
        IMOP_SUBC,
        IMOP_MULC,
        IMOP_DIVC
        };





/* for colormap entries */
typedef struct {
        IBYTE r,g,b,<a class="code" href="class_a.html">a</a>;
        } <a class="code" href="class_irgb_color.html">irgb_color</a>;

typedef struct {
        float r,g,b,<a class="code" href="class_a.html">a</a>;
        } <a class="code" href="class_frgb_color.html">frgb_color</a>;

typedef struct {
        ISHORT r,g,b,<a class="code" href="class_a.html">a</a>;
        } <a class="code" href="class_irgb_short_color.html">irgb_short_color</a>;

/* as pixel types */
typedef struct {
        IBYTE r,g,b;
        } <a class="code" href="class_irgb_pixel.html">irgb_pixel</a>;

typedef struct {
        IBYTE r,g,b,<a class="code" href="class_a.html">a</a>;
        } <a class="code" href="class_irgba_pixel.html">irgba_pixel</a>;




typedef struct <a class="code" href="class_image_.html">image_</a> <a class="code" href="class_image_.html">image</a>;

typedef struct <a class="code" href="class_image_methods_.html">image_methods_</a> {
        int (*query) (<a class="code" href="class_image_.html">image</a> *im,char *filename,char *options);
        int (*open)  (<a class="code" href="class_image_.html">image</a> *im);
        int (*close) (<a class="code" href="class_image_.html">image</a> *im);

        int (*putrows) (<a class="code" href="class_image_.html">image</a> *im,int y1,int nrows,IBYTE *data);
        int (*getrows) (<a class="code" href="class_image_.html">image</a> *im,int y1,int nrows,IBYTE *data);

        } image_methods;

struct <a class="code" href="class_image_.html">image_</a> {
        IBYTE *<a class="code" href="class_image_.html">image</a>;      /* image data */
        int width,height;  /* width and hight of image */

        int imageByRef;   /* flag, its data by ref */ 
        
        char fmt;                 /* format layout of image */
        char compression;  /* compression 0 = uncompressed, 1= RLE */

        int ncolors;       /* number of colors for color mapped images */
        <a class="code" href="class_irgb_color.html">irgb_color</a> *cmap;  /* color map for mapped images */
        <a class="code" href="class_frgb_color.html">frgb_color</a> *fcmap; /* float color map */

        int                colorKey;     /* flag has color key */       
        <a class="code" href="class_irgb_pixel.html">irgb_pixel</a> colorKeyRgb; /* color key in RGB */ 
        int                colorKeyIndex; /* color key index */ 

        int                backgroundIndex; // index of background color
        int                isGray;     /* flag is or was this image a gray scale image ? */     


        int bytesperpixel;        /* bytes per pixel */
        int bytesperscan;         /* bytes per scanline */
        long bytesperimage;       /* bytes for image */
        long compressed_bytesperimage;    /* bytes for image if compressed */

        /* misc infos, dependend of routines */
        long supported_fmts;      /* supported formats, 1 bit per FMT */

        int error;                /* current error */

#if 0
        long key;                 /* HOOPS image key */
        long segkey;              /* HOOPS segment key */
        char *filename;           /* file name */
        char *name;               /* image name */
        char *comment;            /* image comment */
        FILE *file;               /* file */
        void *data;
#endif
        image_methods m;          /* methods */
        };

/* pointer adressing */


#define IROW(im,Y) ((im)-&gt;image+(Y)*(im)-&gt;bytesperscan)

#define IPIX(im,X,Y) ((im)-&gt;image+(Y)*(im)-&gt;bytesperscan+ (X) * (im)-&gt;bytesperpixel)


// prototypes 

extern const char * <a class="code" href="image.h.html#a39">get_image_error_message</a>(
        int im_err);

extern void <a class="code" href="image.h.html#a40">image_zero</a>(
        <a class="code" href="class_image_.html">image</a> * im);

extern int <a class="code" href="image.h.html#a41">image_alloc</a>(
        <a class="code" href="class_image_.html">image</a> * im,
        int fmt,
        int width,
        int height);

extern int <a class="code" href="image.h.html#a42">image_set_fmt</a>(
        <a class="code" href="class_image_.html">image</a> * im,
        int fmt,
        int width,
        int height);

extern int <a class="code" href="image.h.html#a43">image_set_fmt_by_ref</a>(
        <a class="code" href="class_image_.html">image</a> * im,
        int fmt,
        int width,
        int height,
        IBYTE *imageData           /* image data */
        );


extern void <a class="code" href="image.h.html#a44">image_free</a>(
        <a class="code" href="class_image_.html">image</a> * im);

extern int <a class="code" href="image.h.html#a45">image_set_subimage</a>(
        <a class="code" href="class_image_.html">image</a> * im,
        int x,
        int y,
        int width,
        int height,
        <a class="code" href="class_image_.html">image</a> * subim);


extern int <a class="code" href="image.h.html#a46">image_is_gray</a>(
        <a class="code" href="class_image_.html">image</a> * im
        );

extern int <a class="code" href="image.h.html#a47">image_alloc_fcmap</a>(
        <a class="code" href="class_image_.html">image</a> * im,
        int ncolors);

extern void <a class="code" href="image.h.html#a48">image_free_fcmap</a>(
        <a class="code" href="class_image_.html">image</a> * im);

extern int <a class="code" href="image.h.html#a49">image_set_fcmap</a>(
        <a class="code" href="class_image_.html">image</a> * im,
        int i,
        float r,
        float g,
        float b);

extern int <a class="code" href="image.h.html#a50">image_alloc_cmap</a>(
        <a class="code" href="class_image_.html">image</a> * im,
        int ncolors);

extern void <a class="code" href="image.h.html#a51">image_free_cmap</a>(
        <a class="code" href="class_image_.html">image</a> * im);

extern int <a class="code" href="image.h.html#a52">image_set_cmap</a>(
        <a class="code" href="class_image_.html">image</a> * im,
        int i,
        int r,
        int g,
        int b);

extern int <a class="code" href="image.h.html#a53">image_get_cmap</a>(
        <a class="code" href="class_image_.html">image</a> * im,
        int i,
        int * r,
        int * g,
        int * b);

extern void <a class="code" href="image.h.html#a54">image_free_all</a>(
        <a class="code" href="class_image_.html">image</a> * im);

extern int <a class="code" href="image.h.html#a55">image_itof_cmap</a>(
        <a class="code" href="class_image_.html">image</a> * im);

extern int <a class="code" href="image.h.html#a56">image_ftoi_cmap</a>(
        <a class="code" href="class_image_.html">image</a> * im);

extern int <a class="code" href="image.h.html#a57">image_copy_cmap</a>(
        const struct <a class="code" href="class_image_.html">image_</a> * imsrc,
        <a class="code" href="class_image_.html">image</a> * im);

extern int <a class="code" href="image.h.html#a58">image_scale_copy</a>(
        <a class="code" href="class_image_.html">image</a> * iin,
        <a class="code" href="class_image_.html">image</a> * iout);

extern int <a class="code" href="image.h.html#a59">image_scale_copy_filtered</a>(
        <a class="code" href="class_image_.html">image</a> *iin,
        <a class="code" href="class_image_.html">image</a> *iout);


extern int <a class="code" href="image.h.html#a60">image_vflip</a>(
        <a class="code" href="class_image_.html">image</a> * iin,
        <a class="code" href="class_image_.html">image</a> * iout);

extern int <a class="code" href="image.h.html#a61">image_mapped8_to_rgb</a>(
        <a class="code" href="class_image_.html">image</a> * iin,
        <a class="code" href="class_image_.html">image</a> * iout);

extern int <a class="code" href="image.h.html#a62">image_mapped8_to_rgba</a>(<a class="code" href="class_image_.html">image</a> *iin,
        IBYTE alphaColor, 
        IBYTE alpha1, IBYTE alpha2, 
        <a class="code" href="class_image_.html">image</a> *iout);


extern int <a class="code" href="image.h.html#a63">image_rgb_to_rgba</a>(
        <a class="code" href="class_image_.html">image</a> * iin,
        <a class="code" href="class_image_.html">image</a> * iout,
        unsigned char alpha);

extern int <a class="code" href="image.h.html#a64">image_rgba_to_rgb</a>(<a class="code" href="class_image_.html">image</a> *iin,<a class="code" href="class_image_.html">image</a> *iout);


extern int <a class="code" href="image.h.html#a65">image_graya_to_rgba</a>(
        <a class="code" href="class_image_.html">image</a> * iin,
        <a class="code" href="class_image_.html">image</a> * iout
        );

extern int <a class="code" href="image.h.html#a66">image_graya_to_rgb</a>(
        <a class="code" href="class_image_.html">image</a> * iin,
        <a class="code" href="class_image_.html">image</a> * iout
        );

extern int <a class="code" href="image.h.html#a67">image_graya_to_gray</a>(<a class="code" href="class_image_.html">image</a> *iin,<a class="code" href="class_image_.html">image</a> *iout);




extern void <a class="code" href="image.h.html#a68">mapped4_to_mapped8</a>(
        unsigned char * <a class="code" href="class_a.html">a</a>,
        int cnt,
        unsigned char * b);

extern void <a class="code" href="image.h.html#a69">mapped4_to_mapped8_rev</a>(
        unsigned char * <a class="code" href="class_a.html">a</a>,
        int cnt,
        unsigned char * b);

extern void <a class="code" href="image.h.html#a70">mapped8_to_mapped4</a>(
        unsigned char * <a class="code" href="class_a.html">a</a>,
        int cnt,
        unsigned char * b);

extern void <a class="code" href="image.h.html#a71">packed_to_mapped8</a>(
        const unsigned char * <a class="code" href="class_a.html">a</a>,
        int cnt,
        unsigned char * b);

extern void <a class="code" href="image.h.html#a72">packed_to_mapped8_rev</a>(
        const unsigned char * <a class="code" href="class_a.html">a</a>,
        int cnt,
        unsigned char * b);

extern int <a class="code" href="image.h.html#a73">image_packed_to_mapped8</a>(
        <a class="code" href="class_image_.html">image</a> * iin,
        <a class="code" href="class_image_.html">image</a> * iout);

extern int <a class="code" href="image.h.html#a74">pack_byte_run_length</a>(
        int cols,
        const unsigned char * pixel,
        unsigned char * dest_start);

extern int <a class="code" href="image.h.html#a75">unpack_byte_run_length</a>(
        int cols,
        const unsigned char * src,
        unsigned char * dest_start);

extern int <a class="code" href="image.h.html#a76">pack_rgb_run_length</a>(
        int cols,
        <a class="code" href="class_irgb_pixel.html">irgb_pixel</a> * pixel,
        unsigned char * dest_start);

extern int <a class="code" href="image.h.html#a77">unpack_rgb_run_length</a>(
        int cols,
        const unsigned char * src,
        <a class="code" href="class_irgb_pixel.html">irgb_pixel</a> * dest_start);

extern int <a class="code" href="image.h.html#a78">pack_word_run_length</a>(
        int cols,
        const unsigned short * pixel,
        unsigned char * dest_start);

extern int <a class="code" href="image.h.html#a79">unpack_word_run_length</a>(
        int cols,
        const unsigned char * src,
        unsigned short * dest_start);

extern int <a class="code" href="image.h.html#a80">pack_long_run_length</a>(
        int cols,
        const unsigned long * pixel,
        unsigned char * dest_start);

extern int <a class="code" href="image.h.html#a81">unpack_long_run_length</a>(
        int cols,
        const unsigned char * src,
        unsigned long * dest_start);

extern int <a class="code" href="image.h.html#a82">image_pack_rle</a>(
        <a class="code" href="class_image_.html">image</a> * iin,
        <a class="code" href="class_image_.html">image</a> * iout);

extern int <a class="code" href="image.h.html#a83">image_unpack_rle</a>(
        <a class="code" href="class_image_.html">image</a> * iin,
        <a class="code" href="class_image_.html">image</a> * iout);

extern int <a class="code" href="image.h.html#a84">image_get_rgb_color</a>(
        <a class="code" href="class_image_.html">image</a> * im,
        int x,
        int y,
        <a class="code" href="class_irgb_color.html">irgb_color</a> * p);

extern int <a class="code" href="image.h.html#a85">image_alpha_op</a>(
        <a class="code" href="class_image_.html">image</a> * im,
        int op,
        <a class="code" href="class_irgb_color.html">irgb_color</a> * p);

extern int <a class="code" href="image.h.html#a86">image_channel_map</a>(<a class="code" href="class_image_.html">image</a> *im,IBYTE *map,IBYTE *channel);

extern int <a class="code" href="image.h.html#a87">image_rgb_swap</a>(<a class="code" href="class_image_.html">image</a> *im);

/*
  Copy image subrectangle

  iout[xdest:width,ydest:height] = iin[xstart:width,ystart:height]
  iout + iin should have same depth
  no error checking !

  color key support if MAPPED8 format
*/

extern int <a class="code" href="image.h.html#a88">image_copy</a>(  
        <a class="code" href="class_image_.html">image</a> *iin, // src image
        int xstart,int ystart, int width, int height,
        <a class="code" href="class_image_.html">image</a> *iout, // destination image
        int xdest,int ydest,
        
        int useCkey // don"t write transparent pixels of iin
        );


/*
 set subrectangle
 to constant color
*/


extern int <a class="code" href="image.h.html#a89">image_set_8</a>(
        <a class="code" href="class_image_.html">image</a> *iout,    // destination image
        int xdest,int ydest, // position
        int width, int height, // size
        IBYTE color     // color
        );


#ifdef __cplusplus
}
#endif

#endif


</div></pre><hr><address><small>Generated at Thu Jan 27 18:55:25 2000 for blaxxunContact3D by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align=center border=0 
width=118 height=53></a> 1.0.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy; 1997-1999</small></address>
</body>
</html>
