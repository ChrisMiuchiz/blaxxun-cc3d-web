<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<title>GOptimizeTraversal Include File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.0.0 on Thu Jan 27 18:46:04 2000 -->
<center>
<a class="qindex"href="index.html">Main Page</a> &nbsp; <a class="qindex"href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex"href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex"href="annotated.html">Compound List</a> &nbsp; <a class="qindex"href="files.html">File List</a> &nbsp; <a class="qindex"href="headers.html">Header Files</a> &nbsp; <a class="qindex"href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex"href="functions.html">Compound Members</a> &nbsp; <a class="qindex"href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>goptimizetraversal.h</h1>This is the verbatim text of the goptimizetraversal.h include file.<div class="fragment"><pre>/*=============================================================================

This code is licensed under the Web3D-blaxxun Community Source License,
provided in distribution file LICENSE.TXT and available online at
http://www.web3D.org/TaskGroups/x3d/blaxxun/Web3D-blaxxunCommunitySourceAgreement.html
and may only be used for non-commercial use as specified in that license.

THE WEB3D CONSORTIUM AND BLAXXUN DO NOT MAKE AND HEREBY DISCLAIM ANY EXPRESS
OR IMPLIED WARRANTIES RELATING TO THIS CODE, INCLUDING BUT NOT LIMITED TO,
WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE, OR ANY WARRANTIES THAT MIGHT ARISE FROM A COURSE OF DEALING, USAGE
OR TRADE PRACTICE.  THE COMMUNITY SOURCE CODE IS PROVIDED UNDER THIS
AGREEMENT "AS IS," WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
INCLUDING, WITHOUT LIMITATION, WARRANTIES THAT THE COMMUNITY SOURCE CODE ARE
FREE OF DEFECTS, MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE OR
NON-INFRINGING OR IN ANY WAY CONSTITUTE THE COMPLETE PRODUCT MARKETED UNDER
THE NAMES GIVEN SAID CODE.

==============================================================================*/
// GOptimizeTraversal.h
#ifndef _GOptimize_H
#define _GOptimize_H

#include &lt;gvsfnode.h&gt;
#include &lt;gvmfnode.h&gt;
#include &lt;gvsffloat.h&gt;
#include &lt;gvmffloat.h&gt;
#include &lt;gvsfvec2f.h&gt;
#include &lt;gvmfvec2f.h&gt;
#include &lt;gvsfvec3f.h&gt;
#include &lt;gvmfvec3f.h&gt;
#include &lt;gvsfcolor.h&gt;
#include &lt;gvmfcolor.h&gt;
#include &lt;gvsfrotation.h&gt;
#include &lt;gvmfrotation.h&gt;


class <a class="code" href="class_gvimagetexture.html">GvImageTexture</a>;
class <a class="code" href="class_gvcoordinate.html">GvCoordinate</a>;
class <a class="code" href="class_gvtexturecoordinate.html">GvTextureCoordinate</a>;
class GvNormal;
class <a class="code" href="class_gvcolor.html">GvColor</a>;
class <a class="code" href="class_gv2indexedfaceset.html">Gv2IndexedFaceSet</a>;
class <a class="code" href="class_gvinterpolator.html">GvInterpolator</a>;


// rounding support 
inline float <a class="code" href="goptimizetraversal.h.html#a0">GRound</a>(float x,float scale,float xscale)
{ return ((int) (x*xscale))*scale; }

<a class="code" href="class_point.html">Point</a> <a class="code" href="goptimizetraversal.h.html#a0">GRound</a>(const <a class="code" href="class_point.html">Point</a> &amp;p,float scale,float xscale);

inline void <a class="code" href="goptimizetraversal.h.html#a2">GRoundEq</a>(<a class="code" href="class_point.html">Point</a> &amp;p,float scale,float xscale)
{       p.x =<a class="code" href="goptimizetraversal.h.html#a0">GRound</a>(p.x,scale,xscale),
        p.y=<a class="code" href="goptimizetraversal.h.html#a0">GRound</a>(p.y,scale,xscale),
        p.z=<a class="code" href="goptimizetraversal.h.html#a0">GRound</a>(p.z,scale,xscale); 
}


void <a class="code" href="goptimizetraversal.h.html#a0">GRound</a>(<a class="code" href="class_pointarray.html">PointArray</a> &amp;p,float scale,float xscale);
void <a class="code" href="goptimizetraversal.h.html#a0">GRound</a>(<a class="code" href="class_gvmfvec3f.html">GvMFVec3f</a> &amp;p,float scale,float xscale);

//
//      GOptimizeTraversal
//
// traverse graph to build shell for all geometry nodes
class <a class="code" href="class_goptimizetraversal.html">GOptimizeTraversal</a> : public <a class="code" href="class_grendertraversal.html">GRenderTraversal</a> 
{
public :
        <a class="code" href="class_grendertraversal.html#a0">RT</a>(<a class="code" href="class_goptimizetraversal.html">GOptimizeTraversal</a>);

        <a class="code" href="class_goptimizetraversal.html#a1">GOptimizeTraversal</a>();
        
        <a class="code" href="class_goptimizetraversal.html#a2">~GOptimizeTraversal</a>();

        <a class="code" href="class_gvmfnode.html">GvMFNode</a> result;
        int resultMask;

        enum MASK {
                HAS_UNKNOWN_NODE=1,
                HAS_SHAPE=2,
                HAS_GROUP=4,
                HAS_ROUTES=8,
                KEEP_GROUP=8, // if group contains GEOMETRY-SENSOR
                KEEP_TRANSFORM=16, // keep if group contains non transformable geometry
                TRANSFORM_APPLIED=32, // TRANSFORM has been applied to object
                ANCHOR_APPLIED=64         // ANCHOR // SENSORS has been applied to applied 

        };

        enum INTERPOLATOR {
                        IP_KEY,

                        IP_SCALAR,
                        IP_POSITION,
                        IP_ORIENTATION,
                        IP_COLOR,
                        IP_NORMAL,

                        IP_NURBS_POSITION,
                        IP_MAX
        };

        GvBool ignoreRoutes;
        GvBool removeNodeNames;
        GvBool doInlines;
        GvBool applyTransforms;
        
        GvBool applyTexTransform;

        GvBool expandAnchors;
        GvBool expandLods;

        GvBool updateBBox; // update BBoxes of converted / created Groups 
        GvBool buildBspTree;    // build bsp tree

        GvBool keepPrimitives; // keep non IFS VRML primitives

        GvBool decomposeIfs; // decompose IFS
        GvBool compressIfs; // compress IFS

        GvBool optimizeIfs; // optimize IFS
        
        GvBool expandFcIfs; // expand IFS with face colors
        GvBool unlitTextures; // make textured appearances unlit
        

        GvBool bx3d;            // convert to blaxxun3d
        GvBool vrml2;           // convert to VRML2

        // rounding values factor value e.g. 0.01 // for 3 digits 
        GvBool doCoordRound;
        double coordRound;

        GvBool doNormalRound;
        double normalRound;

        GvBool doTexCoordRound;
        double texCoordRound;

        GvBool doColorRound;
        double colorRound;

        GvBool doIpRound[IP_MAX];
        double ipRound[IP_MAX];
        
        GvBool doIpCompress;

        GvBool doLookupCoord; // share Coordinate TexCoord Color etc
        GvBool usePolygon; // use extra Polygon primitive

        // round to nearest value , ok for negative numbers ?
        double <a class="code" href="class_goptimizetraversal.html#a3">round</a>(double value,double factor)  {      return floor((value/factor)+0.5) * factor;}

        void <a class="code" href="class_goptimizetraversal.html#a4">RoundCoord</a>(<a class="code" href="class_gvmfvec3f.html">GvMFVec3f</a> &amp;v);
        void <a class="code" href="class_goptimizetraversal.html#a4">RoundCoord</a>(<a class="code" href="class_gvsffloat.html">GvSFFloat</a> &amp;v);
        
        void <a class="code" href="class_goptimizetraversal.html#a6">RoundTexCoord</a>(<a class="code" href="class_gvmfvec2f.html">GvMFVec2f</a> &amp;v);

        void <a class="code" href="class_goptimizetraversal.html#a7">RoundNormal</a>(<a class="code" href="class_gvmfvec3f.html">GvMFVec3f</a> &amp;v);
        void <a class="code" href="class_goptimizetraversal.html#a7">RoundNormal</a>(<a class="code" href="class_gvsfrotation.html">GvSFRotation</a> &amp;v);
        void <a class="code" href="class_goptimizetraversal.html#a7">RoundNormal</a>(<a class="code" href="class_gvmfrotation.html">GvMFRotation</a> &amp;v);

        void <a class="code" href="class_goptimizetraversal.html#a10">RoundColor</a>(<a class="code" href="class_gvsfcolor.html">GvSFColor</a> &amp;v);
        void <a class="code" href="class_goptimizetraversal.html#a10">RoundColor</a>(<a class="code" href="class_gvmfcolor.html">GvMFColor</a> &amp;v);

        void <a class="code" href="class_goptimizetraversal.html#a12">CompressInterpolator</a> (<a class="code" href="class_gvinterpolator.html">GvInterpolator</a> *ip);

        GvBool includeInline;             // inline exapanded   
        GvBool includeExternProtos;       // externProto ==&gt; PROTO
        GvBool includeImageTextures; // ImageTexture ==&gt; PixelTexture
        
        float smoothCreaseAngle; // 3.14
        float  decomposeVolumeLimit; // a volume limit 


        <a class="code" href="class_gvmfnode.html">GvMFNode</a> imageTextures;
        <a class="code" href="class_gvmfnode.html">GvMFNode</a> materials;
        <a class="code" href="class_gvmfnode.html">GvMFNode</a> appearances;
        <a class="code" href="class_gvmfnode.html">GvMFNode</a> coordinates;
        <a class="code" href="class_gvmfnode.html">GvMFNode</a> textureCoordinates;
        <a class="code" href="class_gvmfnode.html">GvMFNode</a> normals;
        <a class="code" href="class_gvmfnode.html">GvMFNode</a> colors;

        // set of nodes, with animation, kee
        <a class="code" href="class_gvmfnode.html">GvMFNode</a> animatedTransforms;


        // empty result 
        void <a class="code" href="class_goptimizetraversal.html#a13">FlushResult</a>() { result.<a class="code" href="class_gvmfnode.html#a20">deleteAll</a>(); resultMask = 0; }

        // append a resulting node to result list 
        // check for transforms and anchors 
        void <a class="code" href="class_goptimizetraversal.html#a14">AppendResult</a>(<a class="code" href="class_gvnode.html">GvNode</a> *node,int mask=0);

        // return node 
        int <a class="code" href="class_goptimizetraversal.html#a15">ReturnNode</a>(<a class="code" href="class_gvnode.html">GvNode</a> *node,int mask=0);

        // return node 
        int <a class="code" href="class_goptimizetraversal.html#a16">ReturnReplacedNode</a>(<a class="code" href="class_gvnode.html">GvNode</a> *oldNode,<a class="code" href="class_gvnode.html">GvNode</a> *newNode,int mask=0);

        // set result 
        void <a class="code" href="class_goptimizetraversal.html#a17">SetResult</a>(<a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;node,int mask=0) { result.<a class="code" href="class_gvmfnode.html#a6">set</a>(node); resultMask = mask; }

        // store result as single node, and return mask
        int <a class="code" href="class_goptimizetraversal.html#a18">GetResult</a>(<a class="code" href="class_gvnodehandle.html">GvNodeHandle</a> &amp;ret);

        <a class="code" href="class_gvnode.html">GvNode</a>* <a class="code" href="class_goptimizetraversal.html#a19">BuildAnchorOrSensorGroup</a>(<a class="code" href="class_gvnode.html">GvNode</a> *n,int &amp;mask);



        // store result into SFNode, and return mask
        int <a class="code" href="class_goptimizetraversal.html#a18">GetResult</a>(<a class="code" href="class_gvsfnode.html">GvSFNode</a> &amp;ret) {
                        <a class="code" href="class_gvnodehandle.html">GvNodeHandle</a> n;
                        int retMask =  <a class="code" href="class_goptimizetraversal.html#a18">GetResult</a>(n);
                        ret.<a class="code" href="class_gvsfnode.html#a5">set</a>(n);
                        if (n == (<a class="code" href="class_gvnode.html">GvNode</a>*) NULL) ret.<a class="code" href="class_gvfield.html#a5">setDefault</a>(TRUE);
                        return(retMask);
        }

        // append result to MFNode, and return mask
        // includes BSP tree building 

        int <a class="code" href="class_goptimizetraversal.html#a18">GetResult</a>(<a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;ret);

        int <a class="code" href="class_goptimizetraversal.html#a22">GetResultBsp</a>(<a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;ret);

        // true if node should go in bsp optimizer 
        GvBool <a class="code" href="class_goptimizetraversal.html#a23">UseNodeForBsp</a>(<a class="code" href="class_gvnode.html">GvNode</a> *n);

        // do we need to keep the group e.g. if it contains
        // geometry sensors or directional lights 
        GvBool <a class="code" href="class_goptimizetraversal.html#a24">NeedGroup</a>(<a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;in);



        // do we have to create a transform node for result
        GvBool <a class="code" href="class_goptimizetraversal.html#a25">NeedTransform</a>();
        // create transform node and store nodes at children 
        <a class="code" href="class_gvnode.html">GvNode</a>* <a class="code" href="class_goptimizetraversal.html#a26">MakeTransform</a>(<a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;nodes);

        <a class="code" href="class_gvnode.html">GvNode</a>* <a class="code" href="class_goptimizetraversal.html#a27">MakeGroup</a>(<a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;nodes);

        // do we have to create a anchor node for result
        GvBool <a class="code" href="class_goptimizetraversal.html#a28">NeedAnchor</a>();
        <a class="code" href="class_gvnode.html">GvNode</a>* <a class="code" href="class_goptimizetraversal.html#a29">MakeAnchor</a>(<a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;nodes);


        GvBool <a class="code" href="class_goptimizetraversal.html#a30">checkForBx3dNode</a>(<a class="code" href="class_gnode.html">GNode</a> *n);

        // check if appearance already defined, and return looked up appearance
        GvBool <a class="code" href="class_goptimizetraversal.html#a31">Lookup</a>(<a class="code" href="class_gvappearance.html">GvAppearance</a> *old,<a class="code" href="class_gvappearance.html">GvAppearance</a> **new_);
        GvBool <a class="code" href="class_goptimizetraversal.html#a31">Lookup</a>(<a class="code" href="class_gvimagetexture.html">GvImageTexture</a> *old,<a class="code" href="class_gvimagetexture.html">GvImageTexture</a> **new_);
        GvBool <a class="code" href="class_goptimizetraversal.html#a31">Lookup</a>(<a class="code" href="class_gvcoordinate.html">GvCoordinate</a> *old,<a class="code" href="class_gvcoordinate.html">GvCoordinate</a> **new_);
        GvBool <a class="code" href="class_goptimizetraversal.html#a31">Lookup</a>(<a class="code" href="class_gvtexturecoordinate.html">GvTextureCoordinate</a> *old,<a class="code" href="class_gvtexturecoordinate.html">GvTextureCoordinate</a> **new_);
        GvBool <a class="code" href="class_goptimizetraversal.html#a31">Lookup</a>(GvNormal *old,GvNormal **new_);
        GvBool <a class="code" href="class_goptimizetraversal.html#a31">Lookup</a>(<a class="code" href="class_gvcolor.html">GvColor</a> *old,<a class="code" href="class_gvcolor.html">GvColor</a> **new_);

        GvBool <a class="code" href="class_goptimizetraversal.html#a37">LookupCoord</a>(<a class="code" href="class_gv2indexedfaceset.html">Gv2IndexedFaceSet</a> *ifs);



        int <a class="code" href="class_gtraversal.html#a18">Do</a>(<a class="code" href="class_gnode.html">GNode</a> *n) {      
                if (bx3d) if (!<a class="code" href="class_goptimizetraversal.html#a30">checkForBx3dNode</a>(n)) return 0;
                return (n-&gt;<a class="code" href="class_gnode.html#a4">Do</a>(*this)); 
        }

        void <a class="code" href="class_grendertraversal.html#a2">InitializeAttributes</a>(); 

        // process MFNode field and append all results 
        int <a class="code" href="class_gtraversal.html#a18">Do</a>(<a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;n);

        // process MFNode field and append all results to result
        int <a class="code" href="class_gtraversal.html#a18">Do</a>(<a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;n,<a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;result,GvBool buildBsp=FALSE);

        int <a class="code" href="class_gtraversal.html#a18">Do</a>(<a class="code" href="class_gvsfnode.html">GvSFNode</a> &amp;n,<a class="code" href="class_gvsfnode.html">GvSFNode</a> &amp;result);

        int <a class="code" href="class_gtraversal.html#a18">Do</a>(<a class="code" href="class_gvsfnode.html">GvSFNode</a> &amp;n,<a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;result);

};


// tools
class <a class="code" href="class_gv2indexedfaceset.html">Gv2IndexedFaceSet</a>;
class <a class="code" href="class_gshell.html">GShell</a>;
class <a class="code" href="class_gshelli.html">GShellI</a>;


// create a IndexedFaceSet out of shell, wrap == TRUE, flip faces
// optional transformation and texture matrix 

<a class="code" href="class_gv2indexedfaceset.html">Gv2IndexedFaceSet</a>* <a class="code" href="goptimizetraversal.h.html#a5">CreateIndexedFaceSet</a>(<a class="code" href="class_gshell.html">GShell</a> *s, GvBool wrap = FALSE,  <a class="code" href="class_matrix.html">Matrix</a> *m= NULL,<a class="code" href="class_matrix.html">Matrix</a> * tm= NULL,GvBool isSolid= TRUE);
<a class="code" href="class_gv2indexedfaceset.html">Gv2IndexedFaceSet</a>* <a class="code" href="goptimizetraversal.h.html#a5">CreateIndexedFaceSet</a>(<a class="code" href="class_gshelli.html">GShellI</a> *s, GvBool wrap = FALSE,  <a class="code" href="class_matrix.html">Matrix</a> *m= NULL,<a class="code" href="class_matrix.html">Matrix</a> * tm= NULL,GvBool isSolid= TRUE,GvBool bx3d=FALSE);

<a class="code" href="class_gv2indexedfaceset.html">Gv2IndexedFaceSet</a>* <a class="code" href="goptimizetraversal.h.html#a7">NewIfsFromFace</a>(<a class="code" href="class_gtraversal.html">GTraversal</a> &amp;state,<a class="code" href="class_gshell.html">GShell</a> *s, int fcnt, const int fp[], int faceNum, 
                                                                  GvBool wrap = FALSE, GvBool solid = TRUE, <a class="code" href="class_matrix.html">Matrix</a> *m= NULL,<a class="code" href="class_matrix.html">Matrix</a> * tm= NULL);

<a class="code" href="class_gv2indexedfaceset.html">Gv2IndexedFaceSet</a>* <a class="code" href="goptimizetraversal.h.html#a7">NewIfsFromFace</a>(<a class="code" href="class_gtraversal.html">GTraversal</a> &amp;state,<a class="code" href="class_gshelli.html">GShellI</a> *s, int fcnt, const int fp[], int faceNum, 
                                                                  GvBool wrap = FALSE, GvBool solid = TRUE, <a class="code" href="class_matrix.html">Matrix</a> *m= NULL,<a class="code" href="class_matrix.html">Matrix</a> * tm= NULL);

// expand object into single faces IFS
GvBool <a class="code" href="goptimizetraversal.h.html#a9">ExpandIndexedFaceSet</a>(<a class="code" href="class_gtraversal.html">GTraversal</a> &amp;state,<a class="code" href="class_gshell.html">GShell</a> *s, GvBool wrap, GvBool solid,  <a class="code" href="class_matrix.html">Matrix</a> *m,<a class="code" href="class_matrix.html">Matrix</a> * tm, <a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;result);

// create a new material node, and optionally copy settings from m
<a class="code" href="class_gv2material.html">Gv2Material</a> * <a class="code" href="goptimizetraversal.h.html#a10">NewMaterial</a>(<a class="code" href="class_gv2material.html">Gv2Material</a> *m);

// check for VRML 1 shapes &amp; wrap into Shape
void <a class="code" href="goptimizetraversal.h.html#a11">Shapify</a>(<a class="code" href="class_goptimizetraversal.html">GOptimizeTraversal</a> &amp;state,<a class="code" href="class_gvnode.html">GvNode</a> *result,int mask);


/*
  split shell with fc into separate sets 
  need root material

*/
gbool <a class="code" href="goptimizetraversal.h.html#a12">ExpandFaceColors</a>(<a class="code" href="class_gshelli.html">GShellI</a> *s, 
                                          // for appearance creation 
                                          <a class="code" href="class_gv2material.html">Gv2Material</a> *mat,<a class="code" href="class_gvnode.html">GvNode</a> *texture,<a class="code" href="class_gvnode.html">GvNode</a> *textureTranform,
                                          
                                          gbool solid,gbool flip,
                                          
                                          gbool replaceEmmissive,
                                          <a class="code" href="class_gvmfnode.html">GvMFNode</a> &amp;result);




#endif

</div></pre><hr><address><small>Generated at Thu Jan 27 18:46:04 2000 for blaxxunContact3D by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align=center border=0 
width=118 height=53></a> 1.0.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy; 1997-1999</small></address>
</body>
</html>
