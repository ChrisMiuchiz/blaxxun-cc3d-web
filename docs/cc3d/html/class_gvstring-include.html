<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<title>GvString Include File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.0.0 on Thu Jan 27 18:50:01 2000 -->
<center>
<a class="qindex"href="index.html">Main Page</a> &nbsp; <a class="qindex"href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex"href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex"href="annotated.html">Compound List</a> &nbsp; <a class="qindex"href="files.html">File List</a> &nbsp; <a class="qindex"href="headers.html">Header Files</a> &nbsp; <a class="qindex"href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex"href="functions.html">Compound Members</a> &nbsp; <a class="qindex"href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>gvstring.h</h1>This is the verbatim text of the gvstring.h include file.<div class="fragment"><pre>/*=============================================================================

This code is licensed under the Web3D-blaxxun Community Source License,
provided in distribution file LICENSE.TXT and available online at
http://www.web3D.org/TaskGroups/x3d/blaxxun/Web3D-blaxxunCommunitySourceAgreement.html
and may only be used for non-commercial use as specified in that license.

THE WEB3D CONSORTIUM AND BLAXXUN DO NOT MAKE AND HEREBY DISCLAIM ANY EXPRESS
OR IMPLIED WARRANTIES RELATING TO THIS CODE, INCLUDING BUT NOT LIMITED TO,
WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE, OR ANY WARRANTIES THAT MIGHT ARISE FROM A COURSE OF DEALING, USAGE
OR TRADE PRACTICE.  THE COMMUNITY SOURCE CODE IS PROVIDED UNDER THIS
AGREEMENT "AS IS," WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
INCLUDING, WITHOUT LIMITATION, WARRANTIES THAT THE COMMUNITY SOURCE CODE ARE
FREE OF DEFECTS, MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE OR
NON-INFRINGING OR IN ANY WAY CONSTITUTE THE COMPLETE PRODUCT MARKETED UNDER
THE NAMES GIVEN SAID CODE.

==============================================================================*/
#ifndef _GV_STRING_
#define _GV_STRING_

#include &lt;gvbasic.h&gt;
#include &lt;string.h&gt;

//
// GvString
//

// string class, storing a zero terminated C String

class <a class="code" href="class_gvstring.html">GvString</a> {
  public:

        // constructors
    <a class="code" href="class_gvstring.html#a0">GvString</a>()          { string = staticStorage;   string[0] = '\0';  }

    <a class="code" href="class_gvstring.html#a0">GvString</a>( _TCHAR c) { string = staticStorage;  string[0]=c; string[1] = '\0'; }

    <a class="code" href="class_gvstring.html#a0">GvString</a>(LPCTSTR str) { string = staticStorage;  *this = str; }
    <a class="code" href="class_gvstring.html#a0">GvString</a>(LPCTSTR str1,LPCTSTR str2) { string = staticStorage;  *this = str1; *this += str2; }
    <a class="code" href="class_gvstring.html#a0">GvString</a>(const <a class="code" href="class_gvstring.html">GvString</a> &amp;str) { string = staticStorage;   *this = str.string; }

        // destructor
    <a class="code" href="class_gvstring.html#a5">~GvString</a>();
    
        // compute hash code
    u_long              <a class="code" href="class_gvstring.html#a6">hash</a>()          { return <a class="code" href="class_gvstring.html#a6">GvString::hash</a>(string); }

        // get the string length
    int                 <a class="code" href="class_gvstring.html#a7">getLength</a>() const       { return strlen(string); }
    
        // set to empty string 
    void                <a class="code" href="class_gvstring.html#a8">makeEmpty</a>(GvBool freeOld = TRUE);

    // get a C -Style const char *
    LPCTSTR     <a class="code" href="class_gvstring.html#a9">getString</a>() const       { return string; }
        operator LPCTSTR() const { return <a class="code" href="class_gvstring.html#a9">getString</a>(); }  

        // operations 
    <a class="code" href="class_gvstring.html">GvString</a> &amp;          operator =(LPCTSTR str);
    <a class="code" href="class_gvstring.html">GvString</a> &amp;          operator =(const <a class="code" href="class_gvstring.html">GvString</a> &amp;str) { return (*this = str.string); }
    
    <a class="code" href="class_gvstring.html">GvString</a> &amp;          operator +=(LPCTSTR str);
    <a class="code" href="class_gvstring.html">GvString</a> &amp;          operator +=(_TCHAR c);
        
        friend <a class="code" href="class_gvstring.html">GvString</a> operator+(const <a class="code" href="class_gvstring.html">GvString</a>&amp; string1, const <a class="code" href="class_gvstring.html">GvString</a>&amp; string2);
        friend <a class="code" href="class_gvstring.html">GvString</a> operator+(const <a class="code" href="class_gvstring.html">GvString</a>&amp; string, TCHAR ch);
        friend <a class="code" href="class_gvstring.html">GvString</a> operator+(TCHAR ch, const <a class="code" href="class_gvstring.html">GvString</a>&amp; string);
        friend <a class="code" href="class_gvstring.html">GvString</a> operator+(const <a class="code" href="class_gvstring.html">GvString</a>&amp; string, LPCTSTR lpsz);
        friend <a class="code" href="class_gvstring.html">GvString</a> operator+(LPCTSTR lpsz, const <a class="code" href="class_gvstring.html">GvString</a>&amp; string);


    GvBool                              operator !() const { return (string[0] == '\0'); }
    friend GvBool               operator ==(const <a class="code" href="class_gvstring.html">GvString</a> &amp;str, const char *s);
   
    friend GvBool               operator ==(const char *s, const <a class="code" href="class_gvstring.html">GvString</a> &amp;str)
                                                                { return (str == s); }
    
    friend GvBool               operator ==(const <a class="code" href="class_gvstring.html">GvString</a> &amp;str1, const <a class="code" href="class_gvstring.html">GvString</a> &amp;str2) { return (str1 == str2.string); }
    friend GvBool               operator !=(const <a class="code" href="class_gvstring.html">GvString</a> &amp;str, const char *s);
    
    friend GvBool               operator !=(const char *s, const <a class="code" href="class_gvstring.html">GvString</a> &amp;str) { return (str != s); }
    friend GvBool               operator !=(const <a class="code" href="class_gvstring.html">GvString</a> &amp;str1, const <a class="code" href="class_gvstring.html">GvString</a> &amp;str2) { return (str1 != str2.string); }
    
        static u_long   <a class="code" href="class_gvstring.html#a6">hash</a>(const char *s);            

        // similar to CString, allocate buffer
        // create a RW buffer of at least that size
        char *<a class="code" href="class_gvstring.html#a16">getBuffer</a>(int size);

        // release the buffer
        void <a class="code" href="class_gvstring.html#a17">releaseBuffer</a>( int nNewLength = -1 );

        // get quoted
        int <a class="code" href="class_gvstring.html#a18">getQuoted</a>(<a class="code" href="class_gvstring.html">GvString</a> &amp;str);

        // set quoted 
        int <a class="code" href="class_gvstring.html#a19">setQuoted</a>(const <a class="code" href="class_gvstring.html">GvString</a> &amp;str);

        // set character at index to char 
        void <a class="code" href="class_gvstring.html#a20">set1</a>(int index,char c) { if (index&gt;=0 &amp;&amp; index&lt;<a class="code" href="class_gvstring.html#a7">getLength</a>()) string[index]=c; }

        // vrmlscript methods
        //Returns the index of the first occurrence of string in the object, 
        //starting the search from fromIndex. 
        //fromIndex must be between 0 and length -1, where length is the number of characters in the string. If fromIndex is not specified, 
        //the search will start with character 0. 

        int <a class="code" href="class_gvstring.html#a21">indexOf</a>(const <a class="code" href="class_gvstring.html">GvString</a> &amp;search,int fromIndex=0);

        //Returns the index of the first occurrence of string in the object, 
        //starting the search backwards from fromIndex. 
        //fromIndex must be between 0 and length -1, where length is the number of characters in the string. If fromIndex is not specified, 
        //the search will start with character length - 1. 

        int <a class="code" href="class_gvstring.html#a22">lastIndexOf</a>(const <a class="code" href="class_gvstring.html">GvString</a> &amp;search,int fromIndex=-1);

        <a class="code" href="class_gvstring.html">GvString</a>&amp; <a class="code" href="class_gvstring.html#a23">setSubstring</a>(const <a class="code" href="class_gvstring.html">GvString</a> &amp;string, int index1, int index2);
        
        //sets string to the  desired substring. 
        //If index1 is less than index2, the substring returned starts 
        //with the character at index1 and ends with the character before index2. 
        //If index1 is greater than index2, the substring returned starts with the character at index2 and ends with the character before index1. If index1 equals index2, the empty string is returned. index1 and index2 are any integer-valued expressions where 0&lt;=index1, index2&lt;length, where length is the number of characters in the string 

        <a class="code" href="class_gvstring.html">GvString</a>&amp; <a class="code" href="class_gvstring.html#a24">toLowerCase</a>(); 
        //all alphabetic characters of the string converted to lower case. 

        <a class="code" href="class_gvstring.html">GvString</a>&amp; <a class="code" href="class_gvstring.html#a25">toUpperCase</a>(); 
        // all alphabetic characters of the string converted to upper case. 



#ifdef _COM
        // assign by BSTR
        <a class="code" href="class_gvstring.html">GvString</a>&amp;  operator = (BSTR str);

        // get SysAlloced BSTR
        BSTR SysAllocString() const;

    <a class="code" href="class_gvstring.html#a0">GvString</a>(BSTR str) { string = staticStorage;  *this = str; }

#endif



  protected:
    _TCHAR              *string; // allocated string buffer, only if size exceeds STATIC_STORAGE                                                
    int                 storageSize;
                                                                                                
    #define GV_STRING_STATIC_STORAGE_SIZE               16

    _TCHAR              staticStorage[GV_STRING_STATIC_STORAGE_SIZE];

        // expand the buffer
    void                <a class="code" href="class_gvstring.html#b0">expand</a>(int bySize);


        friend class <a class="code" href="class_gvsfstring.html">GvSFString</a>;
        friend class <a class="code" href="class_gvmfstring.html">GvMFString</a>;
};


//
// GvNameEntry
//
// entry in name hash table 

class <a class="code" href="class_gvnameentry.html">GvNameEntry</a> {
 public:
    GvBool              <a class="code" href="class_gvnameentry.html#a0">isEmpty</a>() const   { return (string[0] == '\0'); }
    GvBool              <a class="code" href="class_gvnameentry.html#a1">isEqual</a>(const char *s) const
                    { return (string[0] == s[0] &amp;&amp; ! strcmp(string, s)); }
 private:

    // static NameEntry hashTable
    static int          nameTableSize;
    static <a class="code" href="class_gvnameentry.html">GvNameEntry</a>  **nameTable;
    static struct GvNameChunk *chunk;           // allocate blocks for names

 public:
     
    // init hash table 
    static void <a class="code" href="class_gvnameentry.html#d0">initClass</a>();
    // free chunk table and all table entrys 
    static void <a class="code" href="class_gvnameentry.html#d1">termClass</a>();
    
    // insert string into name-table
    static const <a class="code" href="class_gvnameentry.html">GvNameEntry</a> *  <a class="code" href="class_gvnameentry.html#d2">insert</a>(const char *s);

        // nametable is a global resource, protect by critical section
        static CRITICAL_SECTION locker; // Problem using CCriticalSection in static section
        static BOOL lockerInit;

 private:
    
    const char  *string;
    u_long              hashValue;
    
    <a class="code" href="class_gvnameentry.html">GvNameEntry</a>         *next;  // next element with same hash table entry              
    
    <a class="code" href="class_gvnameentry.html#c0">GvNameEntry</a>(const char *s, u_long h, <a class="code" href="class_gvnameentry.html">GvNameEntry</a> *n)
            { string = s; hashValue = h; next = n; }

friend class <a class="code" href="class_gvname.html">GvName</a>;
};

//
// GvName 
//

// a name holds a token string
// instead of storing the string directly
// identical strings are merged, they are reffering to the same nameEntry
//

class <a class="code" href="class_gvname.html">GvName</a> {
  public:
    <a class="code" href="class_gvname.html#a0">GvName</a>();
    <a class="code" href="class_gvname.html#a0">GvName</a>(const char *s)               { entry = <a class="code" href="class_gvnameentry.html#d2">GvNameEntry::insert</a>(s); }
    <a class="code" href="class_gvname.html#a0">GvName</a>(const <a class="code" href="class_gvstring.html">GvString</a> &amp;s)   { entry = <a class="code" href="class_gvnameentry.html#d2">GvNameEntry::insert</a>(s.<a class="code" href="class_gvstring.html#a9">getString</a>()); }

    <a class="code" href="class_gvname.html#a0">GvName</a>(const <a class="code" href="class_gvname.html">GvName</a> &amp;n)                     { entry = n.entry; }
    <a class="code" href="class_gvname.html#a4">~GvName</a>()                                   {}
    
    const char          *<a class="code" href="class_gvname.html#a5">getString</a>() const      { return entry-&gt;string; }
        operator const char *() const   { return entry-&gt;string; }

    int                 <a class="code" href="class_gvname.html#a7">getLength</a>() const   { return strlen(entry-&gt;string); }
    int <a class="code" href="class_gvname.html#a8">Length</a>() const   { return strlen(entry-&gt;string); }


    static GvBool       <a class="code" href="class_gvname.html#d0">isIdentStartChar</a>(char c,GvBool vrml2);
    static GvBool       <a class="code" href="class_gvname.html#d1">isIdentChar</a>(char c,GvBool vrml2);
    static GvBool       <a class="code" href="class_gvname.html#d2">isNodeNameStartChar</a>(char c,GvBool vrml2);
    static GvBool       <a class="code" href="class_gvname.html#d3">isNodeNameChar</a>(char c,GvBool vrml2);

    int                 operator !() const   { return entry-&gt;<a class="code" href="class_gvnameentry.html#a0">isEmpty</a>(); }
    
        friend int              operator ==(const <a class="code" href="class_gvname.html">GvName</a> &amp;n, const char *s)
        { return n.entry-&gt;isEqual(s); }
    
    friend int          operator ==(const char *s, const <a class="code" href="class_gvname.html">GvName</a> &amp;n)
        { return n.entry-&gt;isEqual(s); }
    
    friend int          operator ==(const <a class="code" href="class_gvname.html">GvName</a> &amp;n1, const <a class="code" href="class_gvname.html">GvName</a> &amp;n2)
        { return n1.entry == n2.entry; }
    friend int          operator !=(const <a class="code" href="class_gvname.html">GvName</a> &amp;n, const char *s)
        { return ! n.entry-&gt;isEqual(s); }
    friend int          operator !=(const char *s, const <a class="code" href="class_gvname.html">GvName</a> &amp;n)
        { return ! n.entry-&gt;isEqual(s); }
    
    friend int          operator !=(const <a class="code" href="class_gvname.html">GvName</a> &amp;n1, const <a class="code" href="class_gvname.html">GvName</a> &amp;n2)
        { return n1.entry != n2.entry; }
  
  private:

    const <a class="code" href="class_gvnameentry.html">GvNameEntry</a>   *entry; // hash table entry
};

#endif /* _GV_STRING_ */
</div></pre><hr><address><small>Generated at Thu Jan 27 18:50:01 2000 for blaxxunContact3D by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align=center border=0 
width=118 height=53></a> 1.0.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy; 1997-1999</small></address>
</body>
</html>
